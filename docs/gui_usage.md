# 勤怠管理ツール GUI使用方法

## 概要

勤怠管理ツールのグラフィカルユーザーインターフェース（GUI）版は、tkinterを使用したデスクトップアプリケーションです。直感的な操作でCSVファイルから勤怠集計を行えます。

## 起動方法

### 方法1: コマンドライン

```bash
attendance-tool-gui
```

### 方法2: Pythonモジュール

```bash
python -m attendance_tool.gui.app
```

### 方法3: 直接実行

```bash
python src/attendance_tool/gui/app.py
```

## メイン画面の構成

### 1. メニューバー

- **ファイル**: 終了
- **設定**: 設定画面を開く
- **ヘルプ**: バージョン情報

### 2. ファイル選択エリア

- **入力CSVファイル**: 勤怠データのCSVファイルを選択
- **出力ディレクトリ**: 集計結果の保存先を選択

### 3. 処理オプション

- **対象月**: 集計対象月を指定（例: 2024-01）

### 4. 実行ボタン

- **集計実行**: 処理を開始

### 5. ログ表示エリア

- 処理状況やエラーメッセージを表示
- **ログクリア**ボタンでログをクリア

## 基本的な使用手順

1. **ファイルを選択**
   - 「参照」ボタンをクリックして入力CSVファイルを選択
   - 「参照」ボタンをクリックして出力ディレクトリを選択

2. **オプションを設定**
   - 対象月を入力（YYYY-MM形式）

3. **実行**
   - 「集計実行」ボタンをクリック
   - プログレス表示で進捗を確認

4. **結果を確認**
   - ログエリアで処理結果を確認
   - 出力ディレクトリに生成されたファイルを確認

## 設定画面

設定メニューから設定画面を開けます。

### 一般設定タブ

- **デフォルト入力ディレクトリ**: ファイル選択時の初期ディレクトリ
- **デフォルト出力ディレクトリ**: 出力先の初期ディレクトリ
- **自動バックアップ**: 出力時にバックアップを作成するか

### ファイル設定タブ

- **文字エンコーディング**: CSVファイルの文字コード
- **日付フォーマット**: 日付の表示形式
- **最大ファイルサイズ**: 処理可能な最大ファイルサイズ（MB）

### 出力設定タブ

- **出力ファイル形式**: CSV、Excelの選択
- **ファイル名テンプレート**: 出力ファイル名の形式
- **タイムスタンプ追加**: ファイル名にタイムスタンプを付加

## 入力ファイル形式

### 必須カラム

- **社員ID**: 従業員を識別するID
- **氏名**: 従業員名
- **日付**: 勤務日（YYYY-MM-DD形式）

### 推奨カラム

- **部署**: 部署名
- **出勤時刻**: 出社時刻（HH:MM形式）
- **退勤時刻**: 退社時刻（HH:MM形式）
- **休憩時間**: 休憩時間（HH:MM形式または分数）

### 例

```csv
社員ID,氏名,部署,日付,出勤時刻,退勤時刻,休憩時間
EMP001,山田太郎,営業部,2024-01-01,09:00,18:00,01:00
EMP002,佐藤花子,開発部,2024-01-01,09:30,18:30,01:00
```

## 出力ファイル

### CSV形式

```csv
社員ID,氏名,部署,出勤日数,総労働時間
EMP001,山田太郎,営業部,21,168
EMP002,佐藤花子,開発部,21,168
```

## エラー対処

### よくあるエラー

1. **「入力ファイルが存在しません」**
   - ファイルパスが正しいか確認
   - ファイルが移動・削除されていないか確認

2. **「出力ディレクトリに書き込み権限がありません」**
   - ディレクトリの権限を確認
   - 管理者権限で実行

3. **「不正なCSVファイルです」**
   - ファイル形式を確認（UTF-8推奨）
   - 必須カラムが含まれているか確認

4. **「処理中にエラーが発生しました」**
   - ログエリアで詳細なエラーメッセージを確認
   - データの形式や内容を確認

## ログファイル

アプリケーションのログは以下の場所に保存されます：

- **Windows**: `%USERPROFILE%\.attendance_tool\logs\gui.log`
- **macOS/Linux**: `~/.attendance_tool/logs/gui.log`

## システム要件

- **OS**: Windows 10/11、macOS 10.14+、Linux
- **Python**: 3.8以上
- **メモリ**: 512MB以上（大容量ファイル処理時は1GB以上推奨）
- **ディスク容量**: 100MB以上の空き容量

## トラブルシューティング

### GUIが起動しない

1. **Pythonのバージョン確認**
   ```bash
   python --version
   ```

2. **tkinterの確認**
   ```bash
   python -c "import tkinter; print('tkinter OK')"
   ```

3. **依存関係のインストール**
   ```bash
   pip install pillow
   ```

### 処理が遅い

- ファイルサイズを確認（100MB以下推奨）
- メモリ使用量を監視
- 他のアプリケーションを終了

## サポート

問題やバグ報告は以下で受け付けています：

- GitHub Issues: [attendance-tool/issues](https://github.com/user/attendance-tool/issues)
- Email: support@attendance-tool.example.com